---
import { getCollection } from 'astro:content';

import Layout from '../layouts/Layout.astro';
import AboutSection from '../components/about/AboutSection.astro';
import ExperienceCard from '../components/experience/ExperienceCard.astro';
import ProjectCard from '../components/projects/ProjectCard.astro';

const experiences = (await getCollection('experience')).sort(
  (a, b) => {
		if (b.data.endDate === 'Present') {
			return 1;
		} else if (a.data.endDate === 'Present') {
			return -1;
		} else {
			return b.data.endDate.valueOf() - a.data.endDate.valueOf()
		}
	},
);

const projects = (await getCollection('projects')).sort(
	(a, b) => b.data.order - a.data.order
)

const about = (await getCollection('about'));

---

<Layout>
	<AboutSection about={about[0]}/>
	<section>
		<h2>Experience</h2>
		<div class="cards">
			{experiences.map((exp) => (
				<ExperienceCard experience={exp} />
			))}
		</div>
	</section>
	<section>
		<h2>Projects</h2>
		<div class="cards">
			{projects.map((proj) => (
				<ProjectCard project={proj} />
			))}
		</div>
	</section>
</Layout>

<style>
	body {
		display: flex;
		flex-direction: column;
		gap: 7rem;
	}

	h2 {
		font-weight: 800;
		font-size: 1.2rem;
		color: var(--color-text-secondary);
	}

	section {
		display: flex;
		flex-direction: column;
		gap: 1rem;

		.cards {
			display: flex;
			flex-direction: row;
			flex-wrap: wrap;
			gap: 2.5rem;
		}
	}
</style>